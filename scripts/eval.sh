export CUDA_VISIBLE_DEVICES=4

# MODEL_NAME_OR_PATH='DatPySci/EleutherAI_pythia-1b-deduped__dpo__tldr'
# betas=("0.01" "0.1")
betas=("0.1")
loss_names=("dpo")
# steps=("3600" "7200" "10800" "14400" "18000" "21600" "25200" "28800" "32400" "36000" "39600" "43200" "46800" "50400" "54000" "57600" "61200" "64800" "68400" "72000" "75600" "79200" "82800" "86400" "90000" "93600" "97200" "100800" "104400" "108000" "111600" "115200" "118800" "122400" "126000" "129600" "133200" "136800" "140400" "144000" "147600" "151200" "154800" "158400" "162000" "165600" "169200" "172800" "176400" "180000" "183600" "187200" "190800" "194400" "198000" "201600" "205200" "208800" "212400" "216000" "219600" "223200" "226800" "230400" "234000" "237600" "241200" "244800" "248400" "252000" "255600" "259200" "262800" "266400" "270000")
steps=("140400" "270000")
# steps=("10800" "21600" "32400" "43200" "75600" "86400" "97200" "108000" "118800" "129600" "140400" "151200" "162000" "172800" "183600" "194400" "205200" "216000" "226800" "237600" "248400" "259200" "270000")

for beta in "${betas[@]}"; do
for loss_name in "${loss_names[@]}"; do
for step in "${steps[@]}"; do
    KEY=on_policy_dpo_pythia-1.4b_beta_0.1_step_${step}
    MODEL_NAME_OR_PATH=models/EleutherAI/pythia-1b-deduped/on_policy_dpo_beta_0.1_44413/step_${step}
    python visualize_tokens.py --model_name_or_path=$MODEL_NAME_OR_PATH \
                            --key=$KEY \
                            --seed=0\
                            --n_samples=512
done
done
done
done